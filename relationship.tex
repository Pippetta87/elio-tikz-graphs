% Author: PÃ¡vel Calado
% the tikz-er2.sty package is available at:
% http://tagus.inesc-id.pt/~pcalado/tikzer2/tikz-er2.
\documentclass[../main.tex]{subfiles}

\begin{document}

\thispagestyle{empty}

\tikzstyle{every entity} = [top color=white, bottom color=blue!30, 
                            draw=blue!50!black!100, drop shadow]
\tikzstyle{every weak entity} = [drop shadow={shadow xshift=.7ex, 
                                 shadow yshift=-.7ex}]
\tikzstyle{every attribute} = [top color=white, bottom color=yellow!20, 
                               draw=yellow, node distance=1cm, drop shadow,text width=1.5cm]
\tikzstyle{every relationship} = [top color=white, bottom color=red!20, 
                                  draw=red!50!black!100, drop shadow,text width=2cm]
\tikzstyle{every isa} = [top color=white, bottom color=green!20, 
                         draw=green!50!black!100, drop shadow,]

\centering
\scalebox{.25}{
\begin{tikzpicture}[node distance=1.5cm, every edge/.style={link}]

  \node[entity] (ssm) at (0,0) {SSM};
\draw[<-]  (ssm.190)--++(190:2cm) node[attribute] (hydro) [above left=2cm and 1cm of ssm] {Equilibrio idrostatico} edge (ssm);
\draw[<-]  (ssm.170)--++(170:2cm) node[attribute] (thermal) [below=of hydro] {Equilibrio termico locale} edge (ssm);
\draw[<-]  (ssm.175)--++(175:2cm) node[attribute] (opacity) [below=of thermal] {Equilibrio radiativo + criterio di Schwartzchild} edge (ssm);
  
  \node[relationship] (calibration) [above =1.5cm of ssm] {Calibrazione luminosit\'a e raggio} edge[<-] (ssm);

\node[entity] (unphys) [above right=1cm and 2cm of ssm] {Incertezze fisica del modello} edge [<-] (ssm);
\node[entity] (corrections) [left=3cm of ssm] {Correzioni} edge [->] (ssm);
\node[entity] (surfaceobs) [above right=1cm and 1cm of calibration] {Osservabili stellari};
\node[entity] (modelobs) [left=3cm of surfaceobs] {Discrepanze modello/osservazioni} edge [->] (corrections);
\node[entity,anchor=north west] (sismobs) at (surfaceobs.south east) {Osservabili sismologiche};
\draw[<-]  (sismobs.20)--++(30:3cm) node[attribute] (freqs) {Frequenze oscillazioni adiabatiche} edge (sismobs);
\draw[<-] (sismobs.5)--++(5:2cm) node[attribute] (radiuscz) {Raggio fondo zona convettiva} edge (sismobs);

\draw[link,<->] (surfaceobs.300) -- node [pos=0.5, auto, swap] {accuratezza} (unphys);
\draw[link,<->] (sismobs.180) -- node [pos=0.5, auto, swap] {accuratezza} (unphys);
\node[draw,purple,fit=(hydro)(thermal)(opacity)(ssm),ellipse,label={[label distance=1cm]150:Modello Solare standard}] at (hydro.west) {};

\end{tikzpicture}

}

\end{document}
